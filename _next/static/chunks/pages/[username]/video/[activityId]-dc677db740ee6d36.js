(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[627],{4247:function(e,t,n){"use strict";var a,i=n(7294);function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}t.Z=function(e){return i.createElement("svg",_extends({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 10 16"},e),a||(a=i.createElement("path",{fill:"currentColor",d:"m3.06.44 6.5 6.499a1.497 1.497 0 0 1 0 2.122l-6.5 6.499a1.5 1.5 0 0 1-2.122-2.121l5.44-5.44L.939 2.56A1.5 1.5 0 1 1 3.06.44Z"})))}},4123:function(e,t,n){"use strict";var a,i,r=n(7294);function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}t.Z=function(e){return r.createElement("svg",_extends({xmlns:"http://www.w3.org/2000/svg",width:32,height:32,fill:"none",className:"LoadingIndicatorIcon_svg__animate-spin LoadingIndicatorIcon_svg__-ml-1 LoadingIndicatorIcon_svg__mr-3 LoadingIndicatorIcon_svg__h-5 LoadingIndicatorIcon_svg__w-5",viewBox:"0 0 24 24"},e),a||(a=r.createElement("circle",{cx:12,cy:12,r:10,stroke:"gray",strokeWidth:4,className:"LoadingIndicatorIcon_svg__opacity-25"})),i||(i=r.createElement("path",{fill:"#000",d:"M4 12a8 8 0 0 1 8-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 0 1 4 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",className:"LoadingIndicatorIcon_svg__opacity-75"})))}},6519:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/[username]/video/[activityId]",function(){return n(6105)}])},1882:function(e,t,n){"use strict";n.d(t,{w:function(){return fbq}});var a=n(4155);let fbq=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=a.env.NEXT_PUBLIC_FB_PIXEL_ID;i&&window.fbq&&window.fbq(e,t,n)}},7141:function(e,t,n){"use strict";n.d(t,{C:function(){return useGetSocialActivity},E:function(){return useReportActivity}});var a=n(8767),i=n(1563),r=n(9473);let useReportActivity=e=>{let{activityId:t,onSuccess:n}=e,r=localStorage.getItem("cafCredToken"),{mutateAsync:o,status:l}=(0,a.useMutation)({mutationFn:e=>(0,i.be)({headers:{"x-credential":r},data:{payload:e},method:"post",url:"/api/social/activity/".concat(t,"/report")}),onSuccess:n});return{status:l,mutateAsync:o}},useGetSocialActivity=e=>{let{activityId:t,onSuccess:n,enabled:o}=e,l=(0,r.v9)(e=>e.auth),{credential:s,credentials:c}=l,d=(null==c?void 0:c.access_token)||s,{data:u,isFetched:m,isLoading:v}=(0,a.useQuery)({queryKey:["social activity ".concat(t)],queryFn:()=>(0,i.be)({url:"".concat("https://api.caffeine.tv","/social/activity/").concat(t),headers:{"x-credential":d}}),enabled:!!o&&!!d,onSuccess:n});return{data:null==u?void 0:u.data,isFetched:m,isLoading:v}}},8272:function(e,t,n){"use strict";n.d(t,{c:function(){return useSocialFeedVodsAPI}});var a=n(1563),i=n(8767),r=n(9473);let useSocialFeedVodsAPI=e=>{let{onSuccess:t,page:n,username:o,enabled:l,limit:s}=e,c=(0,r.v9)(e=>e.auth),{credential:d,credentials:u}=c,m=(null==u?void 0:u.access_token)||d,v=(0,i.useQuery)({queryKey:["social feeds vods ".concat(n),o],refetchOnWindowFocus:!1,queryFn:async()=>await (0,a.be)({url:"/api/social/feeds/".concat(o,"/vods"),headers:{"x-credential":m},params:{next:n,limit:s}}),enabled:!!m&&l,onSuccess:t});return v}},7444:function(e,t,n){"use strict";n.d(t,{_:function(){return useSocialTagAPI}});var a=n(1563),i=n(8767),r=n(9473);let useSocialTagAPI=e=>{let{enabled:t,limit:n=20,onSuccess:o,page:l,tag:s}=e,c=(0,r.v9)(e=>e.auth),{credential:d,credentials:u}=c||{},m=(null==u?void 0:u.access_token)||d,v=(0,i.useQuery)({queryKey:["social feeds live ".concat(l),s],refetchOnWindowFocus:!1,queryFn:async()=>await (0,a.be)({url:"/api/social/tag/".concat(s),headers:{"x-credential":m},params:{limit:n,offset:l}}),enabled:!!m&&t,onSuccess:o});return v}},2648:function(e,t,n){"use strict";n.d(t,{b:function(){return CardRowAvatar}});var a=n(5893),i=n(5675),r=n.n(i);let CardRowAvatar=e=>{let{user:t}=e,n="".concat("https://api-sam.caffeine.tv","/thumb").concat(null==t?void 0:t.avatar_image_path,"?auto=webp&width=20&height=20&fit=crop");return(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(r(),{alt:"avatar",className:"mr-1 h-5 w-5 rounded-full border border-dark-quaternary object-cover",height:20,src:n,unoptimized:!0,width:20}),(0,a.jsx)("p",{className:"font-pop-caption overflow-hidden text-ellipsis font-bold text-dark-secondary",children:t.username||t.name})]})}},7178:function(e,t,n){"use strict";n.d(t,{A:function(){return CardRowVod}});var a,i=n(5893),r=n(2648),o=n(5775),l=n(5675),s=n.n(l),c=n(1664),d=n.n(c),u=n(7294);function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var PlayButtonIcon=function(e){return u.createElement("svg",_extends({xmlns:"http://www.w3.org/2000/svg",width:9,height:12,fill:"currentColor"},e),a||(a=u.createElement("path",{fill:"#fff",d:"m9 6-9 5.196V.804L9 6Z"})))},m=n(3912),v=n(2131),p=n(3389),h=n(906),f=n(4170);let CardRowVod=e=>{let{currentVideo:t,metadataOnTop:n,priority:a,showAvatar:l,video:c}=e,{broadcast_info:u,user:x,username:b,activity_id:g,view_count:w}=c,y=(0,h.G)(w),j=parseFloat(y)>0,_=(null==t?void 0:t.username)===(null==c?void 0:c.username),C=u.broadcast_title.trim(),N=u.content_duration&&(0,v.eh)(u.content_duration),{dateTimeCapitalized:k}=(0,f.I)(null==u?void 0:u.broadcast_start_time),I="/".concat(b,"/video/").concat(g),R=(0,i.jsxs)("div",{className:"font-pop-caption mb-0.5 flex items-center text-ellipsis font-bold text-dark-tertiary",children:[(0,i.jsx)("div",{className:"mr-2",children:t&&(!_||l)?(0,i.jsx)(r.b,{user:x}):(0,i.jsx)("span",{children:k})}),j&&(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)(o.Z,{className:"mr-1",height:10,width:16}),(0,i.jsx)("span",{children:y})]})]});return(0,i.jsx)(d(),{href:I,children:(0,i.jsxs)("div",{className:"flex h-20 max-h-20 w-full items-center rounded-lg bg-dark-quinary px-2 text-white",children:[(0,i.jsxs)("div",{className:"relative mr-3 w-32 max-w-[8rem] overflow-hidden rounded",children:[(0,i.jsx)(PlayButtonIcon,{className:"absolute right-1 top-1 w-3",style:{filter:"drop-shadow(0px 2px 4px rgba(0, 0, 0, 0.50))"}}),(0,i.jsx)("span",{className:"font-pop-label-caption-1 absolute bottom-1 right-1 rounded bg-scrim-medium px-2 py-1 text-dark-secondary",children:N}),(0,i.jsx)(s(),{alt:"preview",className:"h-[4.5rem] w-32 object-cover",height:64,priority:a,sizes:"200px",src:"".concat("https://api-sam.caffeine.tv","/thumb").concat(u.preview_image_path,"?auto=webp&width=171&height=96&fit=crop"),unoptimized:!0,width:114})]}),(0,i.jsxs)("div",{className:"flex flex-1 flex-col justify-center overflow-hidden text-dark-secondary",children:[n&&R,(0,i.jsxs)("h2",{className:"font-pop-card mb-1 line-clamp-2 text-ellipsis font-semibold",children:[(0,p.M2)(u)&&(0,i.jsx)(m.Z,{className:"mr-1 inline-flex align-bottom",height:21,width:21}),C]}),!n&&R]})]})})}},8990:function(e,t,n){"use strict";n.d(t,{o:function(){return BaseHead}});var a=n(5893),i=n(9008),r=n.n(i);let BaseHead=e=>{let{canonicalUrl:t,description:n,title:i}=e;return(0,a.jsxs)(r(),{children:[(0,a.jsx)("title",{children:i}),(0,a.jsx)("meta",{content:i,property:"og:title"}),(0,a.jsx)("meta",{content:n,name:"description"},"desc"),(0,a.jsx)("meta",{content:n,property:"og:description"}),(0,a.jsx)("meta",{content:"website",property:"og:type"}),(0,a.jsx)("meta",{content:"Taimoor",property:"og:site_name"}),(0,a.jsx)("link",{href:"/favicon-v3-32x32.png",rel:"icon",sizes:"32x32",type:"image/png"}),(0,a.jsx)("link",{href:"/apple-touch-icon.png",rel:"apple-touch-icon",type:"image/png"}),(0,a.jsx)("meta",{content:"278354532550167",property:"fb:app_id"}),(0,a.jsx)("meta",{content:i,name:"twitter:title"}),(0,a.jsx)("meta",{content:n,name:"twitter:description"}),(0,a.jsx)("meta",{content:"summary_large_image",name:"twitter:card"}),(0,a.jsx)("meta",{content:"@caffeine",name:"twitter:site"}),(0,a.jsx)("link",{href:t,rel:"canonical"})]})}},6005:function(e,t,n){"use strict";n.d(t,{Z:function(){return VideoHead}});var a=n(5893),i=n(8990),r=n(9238),o=n.n(r),l=n(9008),s=n.n(l),c=n(2131),d=n(3e3),u=n(1163);let VideoHead=e=>{var t,n,r,l,m,v,p,h,f,x;let{video:b}=e,g=(0,u.useRouter)(),{activity_id:w,broadcast_info:y,comment_count:j,description:_,tags:C=[],username:N,view_count:k}=b||{},I="https://www.caffeine.tv",R="".concat(null==y?void 0:y.broadcast_title," | Taimoor"),S=(null==C?void 0:C.length)>0?"#".concat(C.join(", #")):"",O=_||"@".concat(N,": ").concat(null==y?void 0:y.broadcast_title," ").concat(S),L="".concat("".concat("https://api-sam.caffeine.tv","/thumb")).concat(null==y?void 0:y.preview_image_path),A="".concat(I).concat(g.asPath.split("?")[0]),M="",V=null==y?void 0:y.video_url;"0298a480-bc8e-11ee-8080-800057536ec7"===w||"6657f500-aa75-11ee-8080-80011c80ddd7"===w||"e5061200-2c44-11ea-8080-80011126aa68"===w?V="https://api-sam.caffeine.tv/clipper/clip?aid=".concat(w,"&l=60&res=480&ot=f"):"e5061200-2c44-11ea-8080-8000105a86ba"===w?V="https://assets.caffeine.tv/2024/xwLqR1t2i0k.mp4":"ca5a6000-baed-11ee-8080-800140f1eb30"===w&&(V="",M="".concat(I,"/embed").concat(g.asPath.split("?")[0]));let E=(0,d.Z)((0,c.B3)(null==y?void 0:y.content_duration)).replace("0Y0M0D",""),P=!V&&M?JSON.stringify({"@context":"https://schema.org","@type":"VideoObject",name:R,description:O,thumbnailUrl:L,duration:E,contentRating:null==y?void 0:y.content_rating,embedUrl:M,interactionCount:k,uploadDate:null!==(t=null==y?void 0:y.broadcast_start_time)&&void 0!==t?t:"",startTime:null!==(n=null==y?void 0:y.broadcast_start_time)&&void 0!==n?n:"",endTime:null!==(r=null==y?void 0:y.broadcast_end_time)&&void 0!==r?r:"",commentCount:j,creator:"@".concat(N),publication:{"@type":"BroadcastEvent",name:R,isLiveBroadcast:!(null==y?void 0:y.broadcast_end_time),startDate:null!==(l=null==y?void 0:y.broadcast_start_time)&&void 0!==l?l:"",endDate:null!==(m=null==y?void 0:y.broadcast_end_time)&&void 0!==m?m:""}}):V?JSON.stringify({"@context":"https://schema.org","@type":"VideoObject",name:R,description:O,thumbnailUrl:L,duration:E,contentUrl:V,contentRating:null==y?void 0:y.content_rating,interactionCount:k,uploadDate:null!==(v=null==y?void 0:y.broadcast_start_time)&&void 0!==v?v:"",startTime:null!==(p=null==y?void 0:y.broadcast_start_time)&&void 0!==p?p:"",endTime:null!==(h=null==y?void 0:y.broadcast_end_time)&&void 0!==h?h:"",commentCount:j,creator:"@".concat(N),publication:{"@type":"BroadcastEvent",name:R,isLiveBroadcast:!(null==y?void 0:y.broadcast_end_time),startDate:null!==(f=null==y?void 0:y.broadcast_start_time)&&void 0!==f?f:"",endDate:null!==(x=null==y?void 0:y.broadcast_end_time)&&void 0!==x?x:""}}):JSON.stringify({"@context":"https://schema.org","@type":"ImageObject",name:R,description:O,thumbnailUrl:L,contentUrl:A,interactionCount:k,commentCount:j,creator:"@".concat(N)});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(s(),{children:[(0,a.jsx)("meta",{content:"@".concat(N),name:"author"}),(0,a.jsx)("meta",{content:A,property:"og:url"}),(0,a.jsx)("meta",{content:L,property:"og:image"}),(0,a.jsx)("meta",{content:"@".concat(N),property:"og:creator"}),(0,a.jsx)("meta",{content:L,name:"twitter:image"}),S&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("meta",{content:S,name:"keywords"}),(0,a.jsx)("meta",{content:S,property:"og:video:tag"})]}),V&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("meta",{content:V,property:"og:video"}),(0,a.jsx)("meta",{content:V,property:"og:video::secure_url"}),(0,a.jsx)("meta",{content:"application/x-mpegURL",property:"og:video:type"})]}),(0,a.jsx)("meta",{content:"1280",property:"og:".concat(V?"video":"image",":height")}),(0,a.jsx)("meta",{content:"720",property:"og:".concat(V?"video":"image",":width")}),(0,a.jsx)("meta",{content:E,property:"og:video:duration"}),(0,a.jsx)("script",{dangerouslySetInnerHTML:{__html:o().sanitize(P)},type:"application/ld+json"})]}),(0,a.jsx)(i.o,{canonicalUrl:A,description:O,title:R})]})}},8700:function(e,t,n){"use strict";n.d(t,{w:function(){return useObserveOnScroll}});var a=n(7294);let useObserveOnScroll=(e,t)=>{let n=(0,a.useRef)(null);(0,a.useEffect)(()=>{let a=null==e?void 0:e.current;return n.current=new IntersectionObserver(e=>{let[n]=e;n.isIntersecting&&n.target===a&&t()},{root:null,rootMargin:"0px",threshold:1}),n.current&&a&&n.current.observe(a),()=>{n.current&&a&&(n.current.unobserve(a),n.current=null)}},[e,t])}},6105:function(e,t,n){"use strict";n.r(t),n.d(t,{__N_SSP:function(){return ec},default:function(){return _activityId_}});var a,i,r,o,l=n(5893),s=n(8981),c=n(8635),d=n(9473),u=n(7294),m=n(5152),v=n.n(m),p=n(3300),h=n(1163);let f=v()(()=>Promise.all([n.e(554),n.e(409),n.e(162)]).then(n.bind(n,5162)).then(e=>e.UnlockContent),{loadableGenerated:{webpack:()=>[5162]},ssr:!1}),ModalContainer=e=>{var t;let{video:n}=e,a=(0,d.I0)(),{isMobile:i}=(0,p.h)(),r=(0,h.useRouter)(),o=!1===i&&!!(null==n?void 0:n.paywall)&&!(null==n?void 0:null===(t=n.permissions)||void 0===t?void 0:t.paywall_unlocked),s=(0,d.v9)(e=>e.ui),{referrer:m}=s,{modals:{unlockShow:v}}=s;(0,u.useEffect)(()=>{o||a((0,c.Zw)(!1))},[a,o]);let handleCloseUnlock=async()=>{if((null==n?void 0:n.activity_type)==="upcoming"){a((0,c.Zw)(!1));return}setTimeout(()=>{a((0,c.Zw)(!1))},2e3);let e=m?new URL(m):null,t=new URL(location.href);(null==e?void 0:e.href)!==t.href&&(null==e?void 0:e.hostname)===t.hostname?r.push(e.pathname):r.push("/")};return v&&!i?(0,l.jsx)(f,{closeModal:handleCloseUnlock,isOpen:v,video:n}):null};var x=n(6005),b=n(2648),g=n(5775),w=n(5675),y=n.n(w);function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var LiveIcon=function(e){return u.createElement("svg",_extends({xmlns:"http://www.w3.org/2000/svg",width:34,height:16,fill:"none"},e),a||(a=u.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M28.333 4.571c3.125 0 5.667 2.564 5.667 5.715a1.14 1.14 0 0 1-1.001 1.135l-.132.008h-7.74l.005.012a3.408 3.408 0 0 0 3.201 2.273c.91 0 1.763-.356 2.403-1.004.239-.24.557-.352.87-.333l.132.016c.22.04.432.145.602.316a1.15 1.15 0 0 1 0 1.617 5.604 5.604 0 0 1-3.705 1.666l-.302.008c-3.124 0-5.666-2.563-5.666-5.714 0-3.151 2.542-5.715 5.666-5.715Zm-21.533 0c.626 0 1.133.512 1.133 1.143v9.143C7.933 15.49 7.426 16 6.8 16s-1.133-.51-1.133-1.143V5.714c0-.63.507-1.143 1.133-1.143ZM1.133 0c.626 0 1.134.512 1.134 1.143v13.714c0 .632-.508 1.143-1.134 1.143C.508 16 0 15.49 0 14.857V1.143C0 .512.508 0 1.133 0Zm11.215 5.203 3.518 7.096 3.52-7.096a1.129 1.129 0 0 1 1.52-.512c.56.284.788.97.508 1.534l-4.533 9.143c-.018.036-.037.07-.058.103l.058-.103a1.15 1.15 0 0 1-.508.512 1.133 1.133 0 0 1-.357.11l-.015.002a1.064 1.064 0 0 1-.133.008l-.08-.006-.05-.001-.006-.001.136.008a1.125 1.125 0 0 1-.4-.073l-.021-.008a1.012 1.012 0 0 1-.087-.039l-.018-.01a1.373 1.373 0 0 1-.02-.01l.038.02a1.142 1.142 0 0 1-.508-.512L10.32 6.225a1.149 1.149 0 0 1 .508-1.534 1.13 1.13 0 0 1 1.52.512Zm15.985 1.654a3.409 3.409 0 0 0-3.206 2.286h6.412a3.412 3.412 0 0 0-2.986-2.279l-.22-.007ZM7.231.091c.136.058.26.138.374.24.102.115.181.229.238.378.068.137.09.285.09.434 0 .297-.124.594-.328.811-.216.206-.51.332-.805.332a1.69 1.69 0 0 1-.227-.023.716.716 0 0 1-.204-.069.856.856 0 0 1-.204-.103l-.17-.137a1.207 1.207 0 0 1-.328-.811c0-.149.034-.297.09-.434.057-.149.136-.263.238-.378l.17-.137A.855.855 0 0 1 6.37.091a.716.716 0 0 1 .204-.068C6.8-.023 7.027 0 7.231.09Z",clipRule:"evenodd"})))},j=n(3912),_=n(3389),C=n(906);let CardRowLive=e=>{let{currentVideo:t,video:n}=e,{broadcast_info:a,user:i}=n,r=(0,C.G)(n.view_count),o=parseFloat(r)>0,s=(null==t?void 0:t.username)===(null==n?void 0:n.username),c=a.broadcast_title.trim();return(0,l.jsx)("a",{href:"".concat("https://www.caffeine.tv","/").concat(n.username),children:(0,l.jsxs)("div",{className:"flex h-20 max-h-20 w-full items-center rounded-lg bg-dark-quinary px-2 text-white",children:[(0,l.jsxs)("div",{className:"relative mr-3 w-32 max-w-[8rem] overflow-hidden rounded",children:[(0,l.jsx)("div",{className:"absolute flex h-full w-full",style:{background:"linear-gradient(90deg, rgba(0, 0, 255, 0.9) 36.84%, rgba(0, 0, 255, 0) 100%)"},children:(0,l.jsx)("span",{className:"flex flex-1 items-center p-4",children:(0,l.jsx)(LiveIcon,{className:"text-white"})})}),(0,l.jsx)(y(),{alt:"preview",className:"h-[4.5rem] w-32 object-cover",height:64,priority:!0,sizes:"200px",src:"".concat("https://api-sam.caffeine.tv","/thumb").concat(a.preview_image_path,"?auto=webp&width=171&height=96&fit=crop"),unoptimized:!0,width:114})]}),(0,l.jsxs)("div",{className:"font-pop-caption mr-2 flex flex-1 flex-col justify-center overflow-hidden text-dark-tertiary",children:[(0,l.jsxs)("div",{className:"font-pop-caption mb-0.5 flex items-center text-ellipsis font-bold",children:[(0,l.jsx)("div",{className:"mr-2",children:s?(0,l.jsx)("span",{children:"Live Now"}):(0,l.jsx)(b.b,{user:i})}),o&&(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(g.Z,{className:"mr-1",height:10,width:16}),(0,l.jsx)("span",{children:r})]})]}),(0,l.jsxs)("h2",{className:"font-pop-card line-clamp-2 text-ellipsis font-semibold text-dark-secondary",children:[(0,_.M2)(a)&&(0,l.jsx)(j.Z,{className:"mr-1 inline-flex align-bottom",height:21,width:21}),c]})]})]})})};var N=n(7349),k=n(4850),I=n(6592);let CardRowOverlay=()=>(0,l.jsx)("div",{className:"absolute h-full w-full",style:{background:"linear-gradient(90deg, rgba(0, 0, 0, 0.9) 17.98%, rgba(0, 0, 0, 0) 100%)"}});var R=n(1762),S=n(1664),O=n.n(S),L=n(1633),A=n.n(L);let CardRowUpcoming=e=>{let{currentVideo:t,priority:n,video:a}=e,{broadcast_info:i,user:r}=a,o=new Date(a.broadcast_info.broadcast_start_time),s=(null==t?void 0:t.username)===(null==a?void 0:a.username),c=i.broadcast_title.trim(),d=(0,I.Z)(o,(0,N.Z)(new Date,3))?(0,k.Z)(o||"","eeee ha"):A()((0,k.Z)(o||"","eeee ha")),u=(0,k.Z)(o,"MMMM"),m=(0,k.Z)(o,"d"),v="/".concat(a.username,"/video/").concat(a.activity_id);return(0,l.jsx)(O(),{href:v,children:(0,l.jsxs)("div",{className:"flex h-20 max-h-20 w-full items-center rounded-lg bg-dark-quinary px-2 text-white",children:[(0,l.jsxs)("div",{className:"relative mr-3 w-32 max-w-[8rem] overflow-hidden rounded",children:[(0,l.jsx)(CardRowOverlay,{}),(0,l.jsxs)("div",{className:"absolute flex flex-col items-center p-2",children:[(0,l.jsx)("p",{className:"font-pop-label-caption-1 uppercase",children:u}),(0,l.jsx)("p",{className:"font-osw-title-1",children:m})]}),(0,l.jsx)(R.Z,{className:"absolute right-1 top-1 text-white",style:{filter:"drop-shadow(0px 2px 4px rgba(0, 0, 0, 0.50))"}}),(0,l.jsx)(y(),{alt:"preview",className:"h-[4.5rem] w-32 object-cover",height:64,priority:n,sizes:"200px",src:"".concat("https://api-sam.caffeine.tv","/thumb").concat(i.preview_image_path,"?auto=webp&width=171&height=96&fit=crop"),unoptimized:!0,width:114})]}),(0,l.jsxs)("div",{className:"mr-2 flex flex-1 flex-col justify-center overflow-hidden text-dark-tertiary",children:[s?(0,l.jsxs)("span",{className:"font-pop-caption overflow-hidden text-ellipsis font-bold",children:["Live ",d]}):(0,l.jsx)(b.b,{user:r}),(0,l.jsxs)("h2",{className:"font-pop-card line-clamp-2 text-ellipsis font-semibold text-dark-secondary",children:[(0,_.M2)(i)&&(0,l.jsx)(j.Z,{className:"mr-1 inline-flex align-bottom",height:21,width:21}),c]})]})]})})};var M=n(7178),V=n(4123),E=n(2466),P=n(8700);let getListIndexToFetchOnScroll=e=>9===e?e-9:e-10,RelatedVideos=e=>{var t;let{activeTab:n,isFetching:a,setNextPage:i,video:r,relatedContent:o,videos:s,userGroup:c}=e,{isMobile:d}=(0,p.h)(),m=(0,u.useRef)(null),v=(0,u.useRef)({path:"",positionMajor:"",positionMinor:"",slug:"",screenName:""});(0,P.w)(m,()=>{a||i((null==s?void 0:s.page)||1)});let h=(0,u.useCallback)((e,t)=>{v.current.positionMinor=t.toString(),(0,E.oj)("modal_action",{item_type:"discovery_section_video",button_text:n,activity_id:e})},[n]),f=(0,_.sf)(r,null==s?void 0:s.videos),x=(0,_.sf)(r,null==o?void 0:o.upcoming),b=(0,_.sf)(r,null==s?void 0:s.videos),g=n===r.user.username,w=(0,u.useMemo)(()=>"all"!==n?null:null==s?void 0:s.videos.map((e,t)=>{let n=null==e?void 0:e.activity_type;return(0,l.jsxs)("li",{className:"snap-center",onClick:()=>h(null==e?void 0:e.activity_id,t),ref:t===((null==s?void 0:s.videos.length)||0)-10?m:void 0,children:["live"===n&&(0,l.jsx)(CardRowLive,{currentVideo:r,video:e}),"upcoming"===n&&(0,l.jsx)(CardRowUpcoming,{currentVideo:r,priority:t<3,video:e}),"vod"===n&&(0,l.jsx)(M.A,{currentVideo:r,priority:t<3,showAvatar:!0,video:e})]},"reco-".concat(null==e?void 0:e.activity_id,"-").concat(t))}),[n,r,h,null==s?void 0:s.videos]),y=(0,u.useMemo)(()=>n!==r.user.username?null:null==f?void 0:f.map((e,t)=>{let n=getListIndexToFetchOnScroll(f.length);return(0,l.jsx)("li",{className:"snap-center",onClick:()=>h(null==e?void 0:e.activity_id,t),ref:t===n?m:void 0,children:(0,l.jsx)(M.A,{currentVideo:r,priority:t<3,video:e})},"vod-".concat(null==e?void 0:e.activity_id,"-").concat(t))}),[n,r,h,f]),j=(0,u.useMemo)(()=>"all"===n||n===r.user.username?null:null==b?void 0:b.map((e,t)=>{let n=null==e?void 0:e.activity_type,a=getListIndexToFetchOnScroll(b.length);return(0,l.jsxs)("li",{className:"snap-center",onClick:()=>h(null==e?void 0:e.activity_id,t),ref:t===a?m:void 0,children:["live"===n&&(0,l.jsx)(CardRowLive,{currentVideo:r,video:e}),"upcoming"===n&&(0,l.jsx)(CardRowUpcoming,{currentVideo:r,priority:t<3,video:e}),"vod"===n&&(0,l.jsx)(M.A,{currentVideo:r,priority:t<3,video:e})]},"hashtag-".concat(null==e?void 0:e.activity_id,"-").concat(t))}),[n,r,b,h]);return(0,u.useEffect)(()=>{if(null!==d){let e=window.location.pathname,t=v.current;(0,E.oj)("screen_view",{canonical_path:e,clicked_at:new Date().toISOString(),referrer_position_major:t.positionMajor,referrer_position_minor:t.positionMinor,referrer_canonical_path:t.path||document.referrer,referrer_slug:t.slug,referrer_screen_name:t.screenName,screen_name:r.activity_type,web_presentation:d?"mobile":"desktop",experiment_group:"A"===c?"creatorpill_first_position":"all_first_position"}),(()=>{if(t.path=e,t.screenName=r.activity_type,t.slug=n.toLowerCase(),"all"===n)t.positionMajor="A"===c?"1":"0";else if(n===r.user.username)t.positionMajor="A"===c?"0":"1";else{let e=r.tags.indexOf(n);t.positionMajor=(e+2).toString()}})()}},[n,r.activity_type,r.tags,r.user.username,d,c]),(0,l.jsxs)("ul",{className:"flex w-full flex-1 snap-y snap-proximity flex-col gap-y-2 p-4 text-white",children:[(null==o?void 0:null===(t=o.featured)||void 0===t?void 0:t.is_live)&&(0,l.jsx)("li",{className:"snap-center md:hidden",children:(0,l.jsx)(CardRowLive,{video:o.featured})}),null==x?void 0:x.map((e,t)=>{var n;return(d||e.activity_id!==(null==o?void 0:null===(n=o.featured)||void 0===n?void 0:n.activity_id))&&g?(0,l.jsx)("li",{className:"snap-center",children:(0,l.jsx)(CardRowUpcoming,{currentVideo:r,priority:t<3,video:e})},"upcoming-".concat(null==e?void 0:e.activity_id,"-").concat(t)):null}),w,y,j,a&&(0,l.jsx)(V.Z,{className:"flex animate-spin self-center"})]})};var T=n(5518),q=n(1892),Z=n(266),F=n(1563),G=n(8767);let useSocialComments=e=>{let{activityId:t,enabled:n,limit:a=20,next:i,onSuccess:r}=e,o=(0,d.v9)(e=>e.auth),{credential:l,credentials:s}=o,c=(null==s?void 0:s.access_token)||l,{data:u,isLoading:m,error:v,refetch:p}=(0,G.useQuery)({queryKey:["social comments",t],queryFn:()=>(0,F.be)({url:"/api/social/activity/".concat(t,"/comments"),headers:{"x-credential":c},params:{limit:a,next:i}}),enabled:!!n&&!!c&&!!t,onSuccess:r});return{data:null==u?void 0:u.data,isLoading:m,error:v,refreshComments:p}},useSocialCommentReplies=e=>{let{activityId:t,enabled:n,commentId:a,limit:i=100}=e,r=localStorage.getItem("cafCredToken"),{data:o,isLoading:l,error:s,refetch:c}=(0,G.useQuery)({queryKey:["social comment replies",a],queryFn:()=>(0,F.be)({url:"/api/social/activity/".concat(t,"/comment/").concat(a,"/replies"),headers:{"x-credential":r},params:{limit:i}}),enabled:!!n&&!!r&&!!t&&!!a});return{data:null==o?void 0:o.data,isLoading:l,error:s,refreshCommentReplies:c}},useReportComment=e=>{let{activityId:t,commentId:n,onSuccess:a}=e,i=localStorage.getItem("cafCredToken"),{mutateAsync:r,status:o}=(0,G.useMutation)({mutationFn:()=>(0,F.be)({headers:{"x-credential":i},data:{reason:"automatic"},method:"post",url:"/api/social/activity/".concat(t,"/comment/").concat(n,"/report")}),onSuccess:a});return{mutateAsync:r,status:o}},useDeleteComment=e=>{let{activityId:t,commentId:n,onSuccess:a}=e,i=localStorage.getItem("cafCredToken"),{mutateAsync:r,status:o}=(0,G.useMutation)({mutationFn:()=>(0,F.be)({headers:{"x-credential":i},method:"delete",url:"/api/social/activity/".concat(t,"/comment/").concat(n,"/delete")}),onSuccess:a});return{mutateAsync:r,status:o}};var z=n(6215);let PopoverPanelStyled=e=>{let{children:t,className:n,arrowPosition:a}=e;return(0,l.jsx)("div",{className:"relative",children:(0,l.jsx)(z.J.Panel,{className:"".concat(n||"","\n        ").concat("left"===a?"before:left-[-1.25rem] before:top-[0.5rem] before:border-[0.60rem] before:border-r-white \n            after:left-[-1rem] after:top-[0.563rem] after:border-[0.55rem] after:border-r-dark-quinary":"","\n        ").concat("right"===a?"before:right-[-1.25rem] before:top-[0.5rem] before:border-[0.60rem] before:border-l-white \n            after:right-[-1rem] after:top-[0.563rem] after:border-[0.55rem] after:border-l-dark-quinary":"","\n        ").concat("top-left"===a?"before:left-[0.5rem] before:top-[-1.25rem] before:border-[0.60rem] before:border-b-white \n            after:left-[0.563rem] after:top-[-1rem] after:border-[0.55rem] after:border-b-dark-quinary":"","\n        ").concat("top-right"===a?"before:right-[0.5rem] before:top-[-1.25rem] before:border-[0.60rem] before:border-b-white \n            after:right-[0.563rem] after:top-[-1rem] after:border-[0.55rem] after:border-b-dark-quinary":"","\n        ").concat("bottom-left"===a?"before:bottom-[-1.15rem] before:left-[0.5rem] before:border-[0.55rem] before:border-t-white \n            after:bottom-[-0.9rem] after:left-[0.563rem] after:border-[0.46rem] after:border-t-dark-quinary":"","\n        ").concat("bottom-right"===a?"before:bottom-[-1.15rem] before:right-[0.5rem] before:border-[0.55rem] before:border-t-white \n            after:bottom-[-0.9rem] after:right-[0.563rem] after:border-[0.46rem] after:border-t-dark-quinary":"","\n          absolute inline-block min-h-[1.5rem] min-w-[1.5rem] max-w-[30em] bg-dark-quinary \n          py-1 pl-[0.4rem] pr-[1.2rem] text-[1.25em] text-white outline \n          outline-2 \n          outline-white \n          before:absolute \n          before:border-solid \n          before:border-[rgba(0,0,0,0)] \n          after:absolute\n          after:border-solid\n          after:border-[rgba(0,0,0,0)]\n          "),children:t})})};var B=n(4170);let H=v()(()=>Promise.all([n.e(554),n.e(482)]).then(n.bind(n,7482)).then(e=>e.ConfirmationModal),{loadableGenerated:{webpack:()=>[7482]},ssr:!1}),CommentContent=e=>{let{comment:t,onReportComment:n,onRemoveComment:a}=e,[i,r]=(0,u.useState)(!1),[o,s]=(0,u.useState)(!1),{author:c,message_type:d,prop:m,timestamp:v,capabilities:p}=t,h="".concat("https://api-sam.caffeine.tv","/thumb").concat(c.avatar_image_path,"?auto=webp&width=60&height=60&fit=crop"),f=normalizeAssetPath(null==m?void 0:m.universal_video_prop_path),x=(null==p?void 0:p.includes("delete"))&&"deleted"!==d,{dateTime:b}=(0,B.I)(v),{mutateAsync:g}=useDeleteComment({activityId:t.activity_id,commentId:t.id,onSuccess:()=>a(t.id)}),{mutateAsync:w}=useReportComment({activityId:t.activity_id,commentId:t.id,onSuccess:()=>null==n?void 0:n(t.id)});return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"flex items-start",children:[(0,l.jsx)(y(),{alt:"avatar",className:"mr-2 h-10 w-10 rounded-full object-cover",height:40,src:h,unoptimized:!0,width:40}),(0,l.jsxs)("div",{className:"font-pop-caption",children:[(0,l.jsxs)("div",{className:"mb-0.5 flex flex-row",children:[(0,l.jsx)("span",{className:"mr-1 font-semibold",children:c.username}),(0,l.jsx)("span",{className:"text-dark-tertiary",children:b}),(0,l.jsxs)(z.J,{className:"flex flex-row items-center",children:["deleted"!==d&&(0,l.jsx)(z.J.Button,{className:"flex outline-none",children:(0,l.jsx)("div",{className:"ml-1 inline-block cursor-pointer",children:(0,l.jsx)("div",{className:"h-full w-full text-[13px] font-bold",children:"ï¸™"})})}),(0,l.jsxs)(PopoverPanelStyled,{arrowPosition:"top-left",className:"!-left-[22px] !top-5 flex flex-col gap-y-2 !pr-2",children:[(0,l.jsx)("button",{className:" font-pop-caption",onClick:()=>r(!0),children:"Report"}),x&&(0,l.jsx)("button",{className:"font-pop-caption border-t border-gray",onClick:()=>s(!0),children:"Delete"})]})]})]}),"deleted"===d&&(0,l.jsx)("span",{className:"italic text-dark-tertiary",children:"Message deleted"}),"regular"===d&&(0,l.jsx)("span",{className:"text-dark-secondary",children:t.text})]})]}),f&&(0,l.jsx)("video",{autoPlay:!0,className:"relative left-10 w-24",crossOrigin:"anonymous",disableRemotePlayback:!0,loop:!0,muted:!0,playsInline:!0,src:f}),i&&(0,l.jsx)(H,{cancelButtonText:"Cancel",confirmButtonText:"Submit",confirmedCancelText:"Close",confirmedMessage:"Comment Reported",isOpen:i,onClose:()=>r(!1),onSubmit:w,prompt:"Taimoor will be notified that this comment may be inappropriate.",title:"Report Comment"}),o&&(0,l.jsx)(H,{cancelButtonText:"No",confirmButtonText:"Yes",confirmedCancelText:"Close",confirmedMessage:"Comment Deleted",isOpen:o,onClose:()=>s(!1),onSubmit:g,prompt:"Are you sure you want to delete this comment?",title:"Delete Comment"})]})},normalizeAssetPath=e=>e&&e.includes(".zip")?"".concat("https://assets.caffeine.tv").concat(e.replace(".zip","/idle.mp4")):null;function CaretIcon_extends(){return(CaretIcon_extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var CaretIcon=function(e){return u.createElement("svg",CaretIcon_extends({xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true","data-icon":"caret-down","data-prefix":"fas",viewBox:"0 0 320 512"},e),i||(i=u.createElement("path",{fill:"#fff",d:"M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"})))};let CommentReply=e=>{let{comment:t}=e,[n,a]=(0,u.useState)(!1),{activity_id:i,reply_count:r}=t,o="View ".concat(r," ").concat(1===r?"reply":"replies"),{data:s,isLoading:c,refreshCommentReplies:d}=useSocialCommentReplies({activityId:i,enabled:n,commentId:t.id}),m=!c&&(null==s?void 0:s.comments.length)!==r;return(0,l.jsxs)("div",{className:"relative left-12 flex w-max flex-col",children:[(0,l.jsxs)("button",{className:"font-pop-caption flex items-center",onClick:()=>a(e=>!e),children:[(0,l.jsx)(CaretIcon,{className:"h-4 w-4 transition-transform duration-300 ".concat(n?"rotate-0":"rotate-[-90deg]")}),o]}),n&&(0,l.jsxs)(l.Fragment,{children:[(null==s?void 0:s.comments.length)>0&&(0,l.jsx)("ul",{className:"mt-4 transition-opacity duration-500 ease-in-out",children:s.comments.map(e=>{let{id:t}=e;return(0,l.jsx)("li",{className:"mb-2 py-2",children:(0,l.jsx)(CommentContent,{comment:e,onRemoveComment:()=>d()})},t)})}),m&&(0,l.jsx)("span",{className:"font-pop-caption italic text-dark-tertiary",children:"Replies deleted"})]})]})},Comments=e=>{var t,n;let{video:a}=e,{activity_id:i}=a,[r,o]=(0,u.useState)(null),[s,c]=(0,u.useState)(!1),d=(0,u.useRef)(null),m=(0,u.useRef)(null),v=(0,u.useRef)(null);function handleRemoveComment(e){if(r){let t=r.comments.filter(t=>t.id!==e);o({...r,comments:t})}}return(useSocialComments({activityId:i,enabled:!(null==r?void 0:null===(t=r.comments)||void 0===t?void 0:t.length)||s,next:null==r?void 0:r.next,onSuccess:e=>{let{data:t}=e;c(!1),o(e=>({...t,comments:(null==e?void 0:e.comments)?[...e.comments,...t.comments]:t.comments}))}}),(0,u.useEffect)(()=>{let e=m.current;return d.current=new IntersectionObserver(t=>{let[n]=t;n.isIntersecting&&n.target===e&&(null==r?void 0:r.next)&&c(!0)},{root:v.current,rootMargin:"0px",threshold:1}),d.current&&e&&d.current.observe(e),()=>{d.current&&e&&(d.current.unobserve(e),d.current=null)}},[null==r?void 0:r.next]),(0,u.useEffect)(()=>{i&&o(null)},[i]),null==r?void 0:r.comments.length)?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"border-b border-dark-quaternary py-4",children:(0,l.jsx)(Z.A,{isActive:!0,onClick:()=>{var e;return null===(e=v.current)||void 0===e?void 0:e.scrollTo(0,0)},text:"Comments"})}),(0,l.jsx)("section",{className:"h-full overflow-auto text-white",ref:v,children:(0,l.jsx)("ul",{className:"snap-y snap-proximity",children:null==r?void 0:null===(n=r.comments)||void 0===n?void 0:n.map((e,t)=>{var n;let{id:a,message_type:i,reply_count:o}=e;return(0,l.jsxs)("li",{className:"mb-2 flex snap-center flex-col py-2",ref:t===(null==r?void 0:null===(n=r.comments)||void 0===n?void 0:n.length)-10?m:void 0,children:[(0,l.jsx)(CommentContent,{comment:e,onRemoveComment:handleRemoveComment}),"regular"===i&&o>0&&(0,l.jsx)(CommentReply,{comment:e})]},a)})})})]}):null};var U=n(9170),D=n(2314),J=n(4247);function HashtagGradientIcon_extends(){return(HashtagGradientIcon_extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var HashtagGradientIcon=function(e){return u.createElement("svg",HashtagGradientIcon_extends({xmlns:"http://www.w3.org/2000/svg",width:24,height:64,fill:"none"},e),r||(r=u.createElement("path",{fill:"url(#HashtagGradientIcon_svg__a)",d:"M0 0h24v64H0z"})),o||(o=u.createElement("defs",null,u.createElement("linearGradient",{id:"HashtagGradientIcon_svg__a",x1:0,x2:24,y1:33.391,y2:33.391,gradientUnits:"userSpaceOnUse"},u.createElement("stop",{stopOpacity:.01}),u.createElement("stop",{offset:1})))))};let Hashtags=e=>{var t;let{activeTab:n,setActiveTab:a,isLiveCreator:i,video:r,userGroup:o}=e,{user:s}=r,c=s.username,d=(0,u.useRef)(null),m="".concat("https://api-sam.caffeine.tv","/thumb").concat(null==s?void 0:s.avatar_image_path),v=(0,l.jsx)("li",{className:"min-w-fit snap-center",children:(0,l.jsx)(Z.A,{avatarUrl:m,isActive:n===c,isLiveCreator:i,onClick:()=>handleOnClick(c),text:"more"})},"more-from-".concat(c)),p=(0,l.jsx)("li",{className:"snap-center",children:(0,l.jsx)(Z.A,{isActive:"all"===n,onClick:()=>handleOnClick("all"),text:"All"})},"all"),handleOnClick=e=>{(0,E.oj)("modal_action",{button_text:e}),a(e)};return(0,u.useEffect)(()=>{if(d.current){let e=Array.from(d.current.children).find(e=>{var t;return e.textContent==="#".concat(n)||(null===(t=e.textContent)||void 0===t?void 0:t.toLowerCase())===n.toLowerCase()||"more"===e.textContent&&n===c});e&&e.scrollIntoView({behavior:"instant",inline:"center"})}},[n,c]),(0,l.jsx)(D.l,{arrowTransition:!1,containerRef:d,leftArrow:(0,l.jsxs)("div",{className:"absolute left-[-8px] z-10 hidden items-center md:flex",children:[(0,l.jsx)("div",{className:"bg-black",children:(0,l.jsx)("div",{className:"flex h-8 w-8 rotate-180 items-center justify-center rounded-full bg-black hover:bg-accent-1",children:(0,l.jsx)(J.Z,{className:"text-dark-tertiary hover:text-dark-primary"})})}),(0,l.jsx)(HashtagGradientIcon,{className:"rotate-180"})]}),rightArrow:(0,l.jsxs)("div",{className:"absolute right-[-8px] hidden items-center md:flex",children:[(0,l.jsx)(HashtagGradientIcon,{}),(0,l.jsx)("div",{className:"bg-black",children:(0,l.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-black hover:bg-accent-1",children:(0,l.jsx)(J.Z,{className:"text-dark-tertiary hover:text-dark-primary"})})})]}),children:(0,l.jsxs)("ul",{className:"scrollbar-hide flex snap-x snap-proximity gap-x-2 overflow-auto md:py-4",ref:d,children:["A"===o?[v,p]:[p,v],(null===(t=r.tags)||void 0===t?void 0:t.length)>0&&r.tags.map(e=>(0,l.jsx)("li",{className:"snap-center",children:(0,l.jsx)(Z.A,{isActive:n===e,onClick:()=>handleOnClick(e),text:"#".concat(e)})},e))]})})},VideoMetadata=e=>{let{activeTab:t,setActiveTab:n,className:a,isLiveCreator:i,isVisible:r,metadataRef:o,video:s,videos:c,userGroup:d}=e,u=null==c?void 0:c.featured;return(0,l.jsxs)("div",{className:"".concat(a||""),children:[(0,l.jsxs)("section",{className:"w-full bg-black p-4 text-white md:py-0",children:[(0,l.jsx)(U.V,{hasMarquee:!0,isLiveCreator:i,isVisible:r,metadataRef:o,shouldDisplayUnlock:!0,video:s}),u&&(0,l.jsxs)("div",{className:"mr-3 hidden md:block",children:[(null==u?void 0:u.activity_type)==="live"&&(0,l.jsx)(CardRowLive,{currentVideo:u,video:u}),(null==u?void 0:u.activity_type)==="upcoming"&&(0,l.jsx)(CardRowUpcoming,{currentVideo:u,priority:!0,video:u}),(null==u?void 0:u.activity_type)==="vod"&&(0,l.jsx)(M.A,{currentVideo:u,priority:!0,video:u})]}),(0,l.jsx)(Hashtags,{activeTab:t,isLiveCreator:i,setActiveTab:n,userGroup:d,video:s})]}),(0,l.jsx)("hr",{className:"mx-4 border-dark-quaternary"})]})};var K=n(512),Q=n(3096),W=n.n(Q);let X=v()(()=>n.e(538).then(n.bind(n,9538)).then(e=>e.OverlayWithCTA),{loadableGenerated:{webpack:()=>[9538]},ssr:!1}),VideoMainContent=e=>{let{activeTab:t,setActiveTab:n,isLiveCreator:a,renderRelatedVideos:i,renderVideoPlayer:r,scrollContainerRef:o,video:s,videos:c,userGroup:m}=e,{isMobile:v}=(0,p.h)(),[h,f]=(0,u.useState)(!0),x=(0,u.useRef)(null),b=(0,u.useRef)(null),g=(0,d.v9)(e=>e.ui),{comment_count:w}=s,{modals:{registrationShow:y}}=g;return(0,u.useEffect)(()=>{if(!v)return;let e=W()(()=>{y||f(0===window.scrollY)},200);return window.addEventListener("scroll",e,{passive:!0}),()=>{window.removeEventListener("scroll",e)}},[v,y]),(0,l.jsxs)("div",{className:"mx-auto flex pt-16 max-md:min-h-screen max-md:max-w-md max-md:flex-col max-md:items-center md:max-h-screen md:max-w-screen-2xl md:overflow-hidden md:px-4\n      ".concat((null==g?void 0:g.displayAppHeader)?"":"!pt-0","\n      "),children:[(0,l.jsxs)("div",{className:"md:scrollbar-hide w-full text-white max-md:fixed max-md:top-16 max-md:z-20 md:overflow-auto ".concat((null==g?void 0:g.displayAppHeader)?"":"!static"),children:[!!(null==g?void 0:g.displayAppHeader)&&h&&(0,l.jsx)(T.l,{className:"overflow-hidden md:hidden",headerRef:x,isVisible:h,video:s}),(0,l.jsx)("div",{className:"flex w-full flex-col",children:r}),(0,l.jsx)("div",{className:(0,K.Z)("hidden md:block",{"md:h-full md:max-h-[66%]":w>0}),children:w>0&&(0,l.jsx)(Comments,{video:s})}),(0,l.jsx)(VideoMetadata,{activeTab:t,className:"md:hidden",isLiveCreator:a,isVisible:h,metadataRef:b,setActiveTab:n,userGroup:m,video:s})]}),s&&"03b1b980-b3cd-11ed-8080-80005a493b11"!==s.activity_id&&(0,l.jsxs)("aside",{className:"hidden flex-col text-white md:flex md:w-[407px] md:min-w-[407px]",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(T.l,{headerMenu:(0,l.jsx)(q.V,{displayEmbedCode:!0,video:s}),video:s}),(0,l.jsx)(VideoMetadata,{activeTab:t,isLiveCreator:a,setActiveTab:n,userGroup:m,video:s,videos:c})]}),!v&&(0,l.jsx)("div",{className:"flex-1 overflow-auto",ref:o,children:i})]}),v&&(0,l.jsx)("div",{className:"relative pb-14 max-md:block md:hidden ".concat(h?"top-[25rem]":"top-[18rem]"," "),children:i}),v&&(0,l.jsx)(X,{video:s})]})};var Y=n(1882);let $=v()(()=>Promise.all([n.e(554),n.e(721)]).then(n.bind(n,721)).then(e=>e.AdBlockerModal),{loadableGenerated:{webpack:()=>[721]},ssr:!1}),VideoPlayer=e=>{let{video:t}=e,n=(0,h.useRouter)(),{start:a}=n.query,i=(0,u.useRef)(!1),{isMobile:r}=(0,p.h)(),[o,s]=(0,u.useState)(!1),{broadcast_info:c}=t||{},d=Number(a);{let e=new URLSearchParams(window.location.search);e.has("start")&&(a=e.get("start")||"")}let m=a&&d>3?d-3:null,v="".concat("https://www.caffeine.tv","/embed/").concat(null==t?void 0:t.username,"/video/").concat(null==t?void 0:t.activity_id,"?pname=cafplayer&autoPlay=true").concat(m?"&start=".concat(m):"").concat(i.current?"&sizzleDuration=0":""),f="".concat("https://api-sam.caffeine.tv","/thumb").concat(null==c?void 0:c.preview_image_path,"?auto=webp&width=").concat(r?"720":"1280","&fit=crop");return((0,u.useEffect)(()=>{let e;return(null==t?void 0:t.activity_type)==="vod"&&t&&((0,Y.w)("trackCustom","video_start"),e=setTimeout(()=>{(0,Y.w)("trackCustom","video_watched_30s")},3e4)),()=>{(null==t?void 0:t.activity_type)==="vod"&&t&&clearTimeout(e)}},[t]),c)?(0,l.jsxs)("div",{className:"aspect-video",children:[(null==c?void 0:c.video_url)?(0,l.jsx)("iframe",{allow:"clipboard-read; clipboard-write",allowFullScreen:!0,className:"aspect-video w-full",onLoad:e=>{var t;let{target:n}=e;i.current=!0;let a=null==n?void 0:null===(t=n.checkVisibility)||void 0===t?void 0:t.call(n);!1===a&&s(!0)},role:"caffeine-embed",sandbox:"allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation allow-presentation",scrolling:"no",src:v,style:{aspectRatio:"16/9"}},null==t?void 0:t.activity_id):(0,l.jsx)(y(),{alt:"preview",className:"h-full max-h-full w-full object-contain",height:64,priority:!0,sizes:"(max-width: 768px) 100vw, (max-width: 1280px) 50vw, 33vw",src:f,unoptimized:!0,width:64}),o&&(null==c?void 0:c.video_url)&&(0,l.jsx)($,{onClose:()=>{s(!1)},open:o&&!!(null==c?void 0:c.video_url)})]}):null};var ee=n(8272);let useSocialRecommendAPI=e=>{let{onSuccess:t,page:n,activityId:a,enabled:i}=e,r=(0,d.v9)(e=>e.auth),{credential:o,credentials:l}=r,s=(null==l?void 0:l.access_token)||o,c=(0,G.useQuery)({queryKey:["social recommend activity ".concat(n),a],onSuccess:t,refetchOnWindowFocus:!1,queryFn:async()=>await (0,F.be)({url:"/api/social/recommend/activity/".concat(a),params:{page:n},headers:{"x-credential":s}}),enabled:!!s&&i});return c};var et=n(7444),en=n(4021);let useVideoRecommendations=e=>{let{tag:t,type:n,activityId:a,username:i,initialVideos:r}=e,[o,l]=(0,u.useState)(null),[s,c]=(0,u.useState)(r||null);(0,en.Z)(()=>{c(null),l(null)},[n,t]),(0,en.Z)(()=>{c(null),l(null),"vod"===n?v.refetch():"hashtag"===n&&m.refetch()},[a]);let d=useSocialRecommendAPI({page:o,activityId:a,onSuccess:e=>{let{data:t}=e;t.next!==(null==s?void 0:s.page)&&t.activities.length>0&&c({videos:(null==s?void 0:s.videos)?[...s.videos,...t.activities]:t.activities,page:t.next})},enabled:!!a&&"all"===n}),m=(0,et._)({page:o,onSuccess:e=>{let{data:t}=e;t.offset!==(null==s?void 0:s.page)&&c({videos:(null==s?void 0:s.videos)?[...s.videos,...t.activities]:t.activities,page:t.offset})},tag:t,enabled:!!t&&"hashtag"===n}),v=(0,ee.c)({page:o,username:i,onSuccess:e=>{let{data:t}=e;if(parseInt(t.next,10)!==(null==s?void 0:s.page)){let e=(0,C.h)(t.next);c({page:e?parseInt(t.next,10):null==s?void 0:s.page,videos:(null==s?void 0:s.videos)?[...s.videos,...t.vod_activities]:t.vod_activities})}},enabled:"vod"===n&&!!i}),p=d.isLoading||m.isLoading||v.isLoading;return{isLoading:p,videos:s,setNextPage:l}},ea=v()(()=>Promise.all([n.e(554),n.e(218)]).then(n.bind(n,4218)).then(e=>e.WelcomeModal),{loadableGenerated:{webpack:()=>[4218]},ssr:!1}),VideoMain=e=>{var t,n,a,i,r,o;let s,{relatedContent:c,video:d,userGroup:m}=e,[v,h]=(0,u.useState)("B"===m?"all":d.user.username),{isMobile:f}=(0,p.h)(),x=null==c?void 0:null===(t=c.featured)||void 0===t?void 0:t.is_live,b=(0,u.useRef)(null);s=v===d.user.username?"vod":"all"!==v?"hashtag":"all";let{isLoading:g,videos:w,setNextPage:y}=useVideoRecommendations({activityId:d.activity_id,username:d.username,type:s,tag:v,initialVideos:"B"===m?{videos:(null==c?void 0:null===(n=c.recommend)||void 0===n?void 0:n.activities)||[],page:null===(a=c.recommend)||void 0===a?void 0:a.next}:{videos:(null==c?void 0:null===(i=c.vods)||void 0===i?void 0:i.vod_activities)||[],page:(null===(r=c.vods)||void 0===r?void 0:r.next)?parseInt(null===(o=c.vods)||void 0===o?void 0:o.next,10):void 0}}),j=(0,u.useCallback)(()=>{if(f)window.scrollTo(0,0);else{var e;null===(e=b.current)||void 0===e||e.scrollTo(0,0)}},[f]),_=(0,u.useMemo)(()=>(0,l.jsx)(VideoPlayer,{video:d}),[d]),C=(0,u.useMemo)(()=>(0,l.jsx)(RelatedVideos,{activeTab:v,isFetching:g,relatedContent:c,setNextPage:y,userGroup:m,video:d,videos:w}),[v,g,c,y,m,d,w]);return(0,l.jsxs)("main",{children:[(0,l.jsx)(VideoMainContent,{activeTab:v,isLiveCreator:x,renderRelatedVideos:C,renderVideoPlayer:_,scrollContainerRef:b,setActiveTab:e=>{y(null),h(e),j()},userGroup:m,video:d,videos:c}),(0,l.jsx)(ea,{video:d})]})};var ei=n(9245),er=n.n(ei),eo=n(9967),el=n(7141),es=n(819),ec=!0,_activityId_=e=>{var t,n,a;let i;let{relatedContent:r,videoFromServer:o,userGroup:m,referrer:v}=e,f=(0,d.I0)(),b=(0,h.useRouter)(),{isMobile:g}=(0,p.h)(),w=(0,u.useRef)(""),[y,j]=(0,u.useState)(null),_=(0,d.v9)(e=>e.user),C=(0,d.v9)(e=>e.ui),{referrer:N,modals:{registrationShow:k,unlockAfterRegistration:I,unlockAfterVerification:R,unlockShow:S}}=C,O=y||o,L=!1===g&&!!(null==O?void 0:O.paywall)&&!(null==O?void 0:null===(t=O.permissions)||void 0===t?void 0:t.paywall_unlocked),{isLoading:A,isFetched:M}=(0,el.C)({activityId:o.activity_id,enabled:!!(null==O?void 0:O.paywall)&&!!_.isSignin&&null===y,onSuccess:e=>{let{data:t}=e;j(t)}}),{isLoading:V}=(0,es.sL)();return(0,u.useEffect)(()=>{let{username:e,activityId:t}=b.query;t!==w.current&&(w.current=(null==t?void 0:t.toString())||"",j(null),b.replace("/".concat(e,"/video/").concat(t)))},[b]),(0,u.useEffect)(()=>{"upcoming"===O.activity_type||!L||k||V||!1!==_.isSignin&&(!0!==_.isSignin||A||!M)||f((0,c.Zw)(!0)),N||f((0,c.Xi)(v))},[f,M,A,V,v,k,L,N,_.isSignin,O.activity_type]),(0,u.useEffect)(()=>{(I||R)&&!S&&!k&&!V&&!0===_.isSignin&&!A&&M&&(L&&f((0,c.Zw)(!0)),I&&f((0,c.vD)(!1)),R&&f((0,c.Ge)(!1)))},[f,I,k,R,S,V,L,_.isSignin,A,M]),(0,u.useEffect)(()=>{let e={};Object.keys(eo.JY.getInitialState()).forEach(t=>{b.query[t]&&(e={...e,[t]:b.query[t]})}),er()(e)||f((0,s.Vb)(e))},[f,b.query]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(ModalContainer,{video:O}),(0,l.jsx)(x.Z,{video:O}),(0,l.jsx)(VideoMain,{relatedContent:r,userGroup:((i=null===(n=sessionStorage)||void 0===n?void 0:n.getItem("video-recommendation-pill-order"))||(null===(a=sessionStorage)||void 0===a||a.setItem("video-recommendation-pill-order",m),i=m),i),video:O})]})}}},function(e){e.O(0,[980,501,316,851,177,165,774,888,179],function(){return e(e.s=6519)}),_N_E=e.O()}]);